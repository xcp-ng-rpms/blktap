From: Sharath Babu <sharath.babu@citrix.com>
CA-220042: adding error handler for sigemptyset() function

Signed-off-by: Sharath Babu <sharath.babu@citrix.com>
---
 drivers/td-rated.c | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/drivers/td-rated.c b/drivers/td-rated.c
index 743a9a79..d6523022 100644
--- a/drivers/td-rated.c
+++ b/drivers/td-rated.c
@@ -1333,7 +1333,12 @@ rlb_siginit(void)
 		goto fail;
 	}
 
-	sigemptyset(&sigmask);
+	err = sigemptyset(&sigmask);
+	if (err == -1) { 
+		err = -errno;
+		goto fail;
+	}
+
 	sigaddset(&sigmask, SIGINT);
 	sigaddset(&sigmask, SIGTERM);
 	sigaddset(&sigmask, SIGUSR1);
