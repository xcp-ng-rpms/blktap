From 93a15893b4a78eab75b689e250918927d71ae7fa Mon Sep 17 00:00:00 2001
From: Sharath Babu <sharath.babu@citrix.com>
Date: Wed, 31 Aug 2016 05:06:30 +0000
Subject: [PATCH] CA-220042: sigact.sa_mask is not initialized (CID:57552)

Signed-off-by: Sharath Babu <sharath.babu@citrix.com>
---
 tapback/tapback.c |    7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/tapback/tapback.c b/tapback/tapback.c
index 4cfd321..e28f020 100644
--- a/tapback/tapback.c
+++ b/tapback/tapback.c
@@ -546,6 +546,13 @@ tapback_install_sighdl(void)
     sigact.sa_sigaction = &tapback_signal_handler;
     sigact.sa_flags = SA_SIGINFO | SA_NOCLDSTOP | SA_NOCLDWAIT;
 
+    err = sigemptyset(&sigact.sa_mask);
+    if (unlikely(err == -1)) {
+	err = errno;
+	WARN(NULL, "failed to fill empty signal set in sa_mask: %s\n",
+                    strerror(err));
+    }
+
     for (i = 0; i < ARRAY_SIZE(signals); i++) {
         err = sigaction(signals[i], &sigact, NULL);
         if (unlikely(err == -1)) {
-- 
1.7.10.4

